---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/home/Hero.astro";
import Features from "../components/home/Features.astro";
import UseCases from "../components/home/UseCases.astro";
import Audience from "../components/home/Audience.astro";
import Testimonials from "../components/home/Testimonials.astro";
import ShopCTA from "../components/home/ShopCTA.astro";
import LearnMore from "../components/home/LearnMore.astro";
import BlogPreview from "../components/home/BlogPreview.astro";
import { getCollection } from "astro:content";

const homepageCollection = await getCollection("homepage");
if (!homepageCollection) {
  console.error("Homepage collection not found");
}
if (homepageCollection.length === 0) {
  console.error("Homepage collection is empty");
}

const lastElement = homepageCollection[homepageCollection.length - 1];
const homeData = lastElement?.data;
console.log(homeData?.features);

if (!homeData) {
  console.error("Home page data not found in Astro content collection");
}
---

<Layout
  title={homeData?.seo?.metaTitle || "Tiny Explorer - Premium Play Sofas"}
>
  <Hero
    title={homeData?.hero?.title || "Tiny Explorer"}
    subtitle={homeData?.hero?.subtitle}
    ctaText={homeData?.hero?.ctaText || undefined}
    ctaLink={homeData?.hero?.ctaLink || undefined}
    backgroundImage={homeData?.hero?.backgroundImage}
  />
  <Features
    title={homeData?.features?.title || "Why Tiny Explorer?"}
    subtitle={homeData?.features?.subtitle}
    features={homeData?.features?.features || []}
  />
  <UseCases
    title={homeData?.useCases?.title || "What can I do with them?"}
    subtitle={homeData?.useCases?.subtitle}
    activities={homeData?.useCases?.activities || []}
    ctaText={homeData?.useCases?.ctaText || undefined}
    ctaLink={homeData?.useCases?.ctaLink || undefined}
    image={homeData?.useCases?.image}
  />
  <Audience
    title={homeData?.audience?.title || "Who are they for?"}
    subtitle={homeData?.audience?.subtitle}
    audiences={homeData?.audience?.audiences || []}
  />
  <Testimonials
    title={homeData?.testimonials?.title || "What our customers say"}
    testimonials={homeData?.testimonials?.testimonials}
  />
  <ShopCTA
    title={homeData?.cta?.title || "Ready to Play?"}
    subtitle={homeData?.cta?.subtitle}
    buttons={homeData?.cta?.buttons}
  />
  <LearnMore
    title={homeData?.learnMore?.title || "Learn More"}
    cards={homeData?.learnMore?.cards}
  />
  <BlogPreview
    title={homeData?.blog?.title || "From the Blog"}
    subtitle={homeData?.blog?.subtitle}
    limit={homeData?.blog?.limit}
  />
</Layout>
